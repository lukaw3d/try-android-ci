!function(e,t,n,r,i){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},u="function"==typeof a[r]&&a[r],o=u.cache||{},s="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function newRequire(t,n){if(!o[t]){if(!e[t]){var i="function"==typeof a[r]&&a[r];if(!n&&i)return i(t,!0);if(u)return u(t,!0);if(s&&"string"==typeof t)return s(t);var c=Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}localRequire.resolve=function(n){var r=e[t][1][n];return null!=r?r:n},localRequire.cache={};var l=o[t]=new newRequire.Module(t);e[t][0].call(l.exports,localRequire,l,l.exports,this)}return o[t].exports;function localRequire(e){var t=localRequire.resolve(e);return!1===t?{}:newRequire(t)}}newRequire.isParcelRequire=!0,newRequire.Module=function(e){this.id=e,this.bundle=newRequire,this.exports={}},newRequire.modules=e,newRequire.cache=o,newRequire.parent=u,newRequire.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(newRequire,"root",{get:function(){return a[r]}}),a[r]=newRequire;for(var c=0;c<t.length;c++)newRequire(t[c]);if(n){var l=newRequire(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):i&&(this[i]=l)}}({"8m3QJ":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"BluetoothLeWeb",function(){return f});var i=e("@swc/helpers/_/_assert_this_initialized"),a=e("@swc/helpers/_/_async_to_generator"),u=e("@swc/helpers/_/_class_call_check"),o=e("@swc/helpers/_/_create_class"),s=e("@swc/helpers/_/_inherits"),c=e("@swc/helpers/_/_create_super"),l=e("@swc/helpers/_/_ts_generator"),v=e("@capacitor/core"),h=e("./conversion"),d=e("./timeout"),f=function(e){"use strict";(0,s._)(BluetoothLeWeb,e);var t=(0,c._)(BluetoothLeWeb);function BluetoothLeWeb(){var e;return(0,u._)(this,BluetoothLeWeb),e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments))),e.deviceMap=new Map,e.discoveredDevices=new Map,e.scan=null,e.DEFAULT_CONNECTION_TIMEOUT=1e4,e.onAdvertisementReceivedCallback=e.onAdvertisementReceived.bind((0,i._)(e)),e.onDisconnectedCallback=e.onDisconnected.bind((0,i._)(e)),e.onCharacteristicValueChangedCallback=e.onCharacteristicValueChanged.bind((0,i._)(e)),e}return(0,o._)(BluetoothLeWeb,[{key:"initialize",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){switch(t.label){case 0:if("undefined"==typeof navigator||!navigator.bluetooth)throw e.unavailable("Web Bluetooth API not available in this browser.");return[4,navigator.bluetooth.getAvailability()];case 1:if(!t.sent())throw e.unavailable("No Bluetooth radio available.");return[2]}})})()}},{key:"isEnabled",value:function(){return(0,a._)(function(){return(0,l._)(this,function(e){return[2,{value:!0}]})})()}},{key:"enable",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("enable is not available on web.")})})()}},{key:"disable",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("disable is not available on web.")})})()}},{key:"startEnabledNotifications",value:function(){return(0,a._)(function(){return(0,l._)(this,function(e){return[2]})})()}},{key:"stopEnabledNotifications",value:function(){return(0,a._)(function(){return(0,l._)(this,function(e){return[2]})})()}},{key:"isLocationEnabled",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("isLocationEnabled is not available on web.")})})()}},{key:"openLocationSettings",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("openLocationSettings is not available on web.")})})()}},{key:"openBluetoothSettings",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("openBluetoothSettings is not available on web.")})})()}},{key:"openAppSettings",value:function(){var e=this;return(0,a._)(function(){return(0,l._)(this,function(t){throw e.unavailable("openAppSettings is not available on web.")})})()}},{key:"setDisplayStrings",value:function(){return(0,a._)(function(){return(0,l._)(this,function(e){return[2]})})()}},{key:"requestDevice",value:function(e){var t=this;return(0,a._)(function(){var n,r;return(0,l._)(this,function(i){switch(i.label){case 0:return n=t.getFilters(e),[4,navigator.bluetooth.requestDevice({filters:n.length?n:void 0,optionalServices:null==e?void 0:e.optionalServices,acceptAllDevices:0===n.length})];case 1:return r=i.sent(),t.deviceMap.set(r.id,r),[2,t.getBleDevice(r)]}})})()}},{key:"requestLEScan",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return t.requestBleDeviceOptions=e,n=t.getFilters(e),[4,t.stopLEScan()];case 1:return r.sent(),t.discoveredDevices=new Map,navigator.bluetooth.removeEventListener("advertisementreceived",t.onAdvertisementReceivedCallback),navigator.bluetooth.addEventListener("advertisementreceived",t.onAdvertisementReceivedCallback),[4,navigator.bluetooth.requestLEScan({filters:n.length?n:void 0,acceptAllAdvertisements:0===n.length,keepRepeatedDevices:null==e?void 0:e.allowDuplicates})];case 2:return t.scan=r.sent(),[2]}})})()}},{key:"onAdvertisementReceived",value:function(e){var t,n,r=e.device.id;if(this.deviceMap.set(r,e.device),!this.discoveredDevices.has(r)||(null===(t=this.requestBleDeviceOptions)||void 0===t?void 0:t.allowDuplicates)){this.discoveredDevices.set(r,!0);var i=this.getBleDevice(e.device),a={device:i,localName:i.name,rssi:e.rssi,txPower:e.txPower,manufacturerData:(0,h.mapToObject)(e.manufacturerData),serviceData:(0,h.mapToObject)(e.serviceData),uuids:null===(n=e.uuids)||void 0===n?void 0:n.map(h.webUUIDToString)};this.notifyListeners("onScanResult",a)}}},{key:"stopLEScan",value:function(){var e=this;return(0,a._)(function(){var t;return(0,l._)(this,function(n){return(null===(t=e.scan)||void 0===t?void 0:t.active)&&e.scan.stop(),e.scan=null,[2]})})()}},{key:"getDevices",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(n){switch(n.label){case 0:return[4,navigator.bluetooth.getDevices()];case 1:return[2,{devices:n.sent().filter(function(t){return e.deviceIds.includes(t.id)}).map(function(e){return t.deviceMap.set(e.id,e),t.getBleDevice(e)})}]}})})()}},{key:"getConnectedDevices",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){switch(e.label){case 0:return[4,navigator.bluetooth.getDevices()];case 1:return[2,{devices:e.sent().filter(function(e){var t;return null===(t=e.gatt)||void 0===t?void 0:t.connected}).map(function(e){return t.deviceMap.set(e.id,e),t.getBleDevice(e)})}]}})})()}},{key:"connect",value:function(e){var t=this;return(0,a._)(function(){var n,r,i,a,u,o;return(0,l._)(this,function(s){switch(s.label){case 0:if((i=t.getDeviceFromMap(e.deviceId)).removeEventListener("gattserverdisconnected",t.onDisconnectedCallback),i.addEventListener("gattserverdisconnected",t.onDisconnectedCallback),a=Symbol(),void 0===i.gatt)throw Error("No gatt server available.");s.label=1;case 1:return s.trys.push([1,3,,5]),u=null!==(n=e.timeout)&&void 0!==n?n:t.DEFAULT_CONNECTION_TIMEOUT,[4,(0,d.runWithTimeout)(i.gatt.connect(),u,a)];case 2:return s.sent(),[3,5];case 3:return o=s.sent(),[4,null===(r=i.gatt)||void 0===r?void 0:r.disconnect()];case 4:if(s.sent(),o===a)throw Error("Connection timeout");throw o;case 5:return[2]}})})()}},{key:"onDisconnected",value:function(e){var t=`disconnected|${e.target.id}`;this.notifyListeners(t,null)}},{key:"createBond",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("createBond is not available on web.")})})()}},{key:"isBonded",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("isBonded is not available on web.")})})()}},{key:"disconnect",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){return null===(n=t.getDeviceFromMap(e.deviceId).gatt)||void 0===n||n.disconnect(),[2]})})()}},{key:"getServices",value:function(e){var t=this;return(0,a._)(function(){var n,r,i,a,u,o,s,c,v,h,d,f,p,_,b,g,w,y,m,D,k;return(0,l._)(this,function(l){switch(l.label){case 0:return[4,null===(n=t.getDeviceFromMap(e.deviceId).gatt)||void 0===n?void 0:n.getPrimaryServices()];case 1:i=null!==(r=l.sent())&&void 0!==r?r:[],a=[],u=!0,o=!1,s=void 0,l.label=2;case 2:l.trys.push([2,15,16,17]),c=i[Symbol.iterator](),l.label=3;case 3:if(u=(v=c.next()).done)return[3,14];return[4,(h=v.value).getCharacteristics()];case 4:d=l.sent(),f=[],p=!0,_=!1,b=void 0,l.label=5;case 5:l.trys.push([5,10,11,12]),g=d[Symbol.iterator](),l.label=6;case 6:if(p=(w=g.next()).done)return[3,9];return y=w.value,m=f.push,D={uuid:y.uuid,properties:t.getProperties(y)},[4,t.getDescriptors(y)];case 7:m.apply(f,[(D.descriptors=l.sent(),D)]),l.label=8;case 8:return p=!0,[3,6];case 9:return[3,12];case 10:return k=l.sent(),_=!0,b=k,[3,12];case 11:try{p||null==g.return||g.return()}finally{if(_)throw b}return[7];case 12:a.push({uuid:h.uuid,characteristics:f}),l.label=13;case 13:return u=!0,[3,3];case 14:return[3,17];case 15:return k=l.sent(),o=!0,s=k,[3,17];case 16:try{u||null==c.return||c.return()}finally{if(o)throw s}return[7];case 17:return[2,{services:a}]}})})()}},{key:"getDescriptors",value:function(e){return(0,a._)(function(){return(0,l._)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.getDescriptors()];case 1:return[2,t.sent().map(function(e){return{uuid:e.uuid}})];case 2:return t.sent(),[2,[]];case 3:return[2]}})})()}},{key:"getProperties",value:function(e){return{broadcast:e.properties.broadcast,read:e.properties.read,writeWithoutResponse:e.properties.writeWithoutResponse,write:e.properties.write,notify:e.properties.notify,indicate:e.properties.indicate,authenticatedSignedWrites:e.properties.authenticatedSignedWrites,reliableWrite:e.properties.reliableWrite,writableAuxiliaries:e.properties.writableAuxiliaries}}},{key:"getCharacteristic",value:function(e){var t=this;return(0,a._)(function(){var n,r;return(0,l._)(this,function(i){switch(i.label){case 0:return[4,null===(n=t.getDeviceFromMap(e.deviceId).gatt)||void 0===n?void 0:n.getPrimaryService(null==e?void 0:e.service)];case 1:return[2,null==(r=i.sent())?void 0:r.getCharacteristic(null==e?void 0:e.characteristic)]}})})()}},{key:"getDescriptor",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return[4,t.getCharacteristic(e)];case 1:return[2,null==(n=r.sent())?void 0:n.getDescriptor(null==e?void 0:e.descriptor)]}})})()}},{key:"discoverServices",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("discoverServices is not available on web.")})})()}},{key:"getMtu",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("getMtu is not available on web.")})})()}},{key:"requestConnectionPriority",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("requestConnectionPriority is not available on web.")})})()}},{key:"readRssi",value:function(e){var t=this;return(0,a._)(function(){return(0,l._)(this,function(e){throw t.unavailable("readRssi is not available on web.")})})()}},{key:"read",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return[4,t.getCharacteristic(e)];case 1:return[4,null==(n=r.sent())?void 0:n.readValue()];case 2:return[2,{value:r.sent()}]}})})()}},{key:"write",value:function(e){var t=this;return(0,a._)(function(){var n,r;return(0,l._)(this,function(i){switch(i.label){case 0:return[4,t.getCharacteristic(e)];case 1:return n=i.sent(),r="string"==typeof e.value?(0,h.hexStringToDataView)(e.value):e.value,[4,null==n?void 0:n.writeValueWithResponse(r)];case 2:return i.sent(),[2]}})})()}},{key:"writeWithoutResponse",value:function(e){var t=this;return(0,a._)(function(){var n,r;return(0,l._)(this,function(i){switch(i.label){case 0:return[4,t.getCharacteristic(e)];case 1:return n=i.sent(),r="string"==typeof e.value?(0,h.hexStringToDataView)(e.value):e.value,[4,null==n?void 0:n.writeValueWithoutResponse(r)];case 2:return i.sent(),[2]}})})()}},{key:"readDescriptor",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return[4,t.getDescriptor(e)];case 1:return[4,null==(n=r.sent())?void 0:n.readValue()];case 2:return[2,{value:r.sent()}]}})})()}},{key:"writeDescriptor",value:function(e){var t=this;return(0,a._)(function(){var n,r;return(0,l._)(this,function(i){switch(i.label){case 0:return[4,t.getDescriptor(e)];case 1:return n=i.sent(),r="string"==typeof e.value?(0,h.hexStringToDataView)(e.value):e.value,[4,null==n?void 0:n.writeValue(r)];case 2:return i.sent(),[2]}})})()}},{key:"startNotifications",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return[4,t.getCharacteristic(e)];case 1:return null==(n=r.sent())||n.removeEventListener("characteristicvaluechanged",t.onCharacteristicValueChangedCallback),null==n||n.addEventListener("characteristicvaluechanged",t.onCharacteristicValueChangedCallback),[4,null==n?void 0:n.startNotifications()];case 2:return r.sent(),[2]}})})()}},{key:"onCharacteristicValueChanged",value:function(e){var t,n,r=e.target,i=`notification|${null===(t=r.service)||void 0===t?void 0:t.device.id}|${null===(n=r.service)||void 0===n?void 0:n.uuid}|${r.uuid}`;this.notifyListeners(i,{value:r.value})}},{key:"stopNotifications",value:function(e){var t=this;return(0,a._)(function(){var n;return(0,l._)(this,function(r){switch(r.label){case 0:return[4,t.getCharacteristic(e)];case 1:return[4,null==(n=r.sent())?void 0:n.stopNotifications()];case 2:return r.sent(),[2]}})})()}},{key:"getFilters",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,u,o=(null!==(a=null==e?void 0:e.services)&&void 0!==a?a:[])[Symbol.iterator]();!(n=(u=o.next()).done);n=!0){var s=u.value;t.push({services:[s],name:null==e?void 0:e.name,namePrefix:null==e?void 0:e.namePrefix})}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return((null==e?void 0:e.name)||(null==e?void 0:e.namePrefix))&&0===t.length&&t.push({name:e.name,namePrefix:e.namePrefix}),t}},{key:"getDeviceFromMap",value:function(e){var t=this.deviceMap.get(e);if(void 0===t)throw Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');return t}},{key:"getBleDevice",value:function(e){var t;return{deviceId:e.id,name:null!==(t=e.name)&&void 0!==t?t:void 0}}}]),BluetoothLeWeb}(v.WebPlugin)},{"@swc/helpers/_/_assert_this_initialized":"1a6MR","@swc/helpers/_/_async_to_generator":"6SrlH","@swc/helpers/_/_class_call_check":"hcHZl","@swc/helpers/_/_create_class":"dr6J2","@swc/helpers/_/_inherits":"37q8d","@swc/helpers/_/_create_super":"14F0p","@swc/helpers/_/_ts_generator":"dgtxH","@capacitor/core":"9nVQl","./conversion":"lL5Pr","./timeout":"hepty","@parcel/transformer-js/src/esmodule-helpers.js":"bFO5N"}],hepty:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"runWithTimeout",function(){return runWithTimeout});var i=e("@swc/helpers/_/_async_to_generator"),a=e("@swc/helpers/_/_ts_generator");function runWithTimeout(e,t,n){return _runWithTimeout.apply(this,arguments)}function _runWithTimeout(){return(_runWithTimeout=(0,i._)(function(e,t,n){var r;return(0,a._)(this,function(i){return[2,Promise.race([e,new Promise(function(e,i){r=setTimeout(function(){return i(n)},t)})]).finally(function(){return clearTimeout(r)})]})})).apply(this,arguments)}},{"@swc/helpers/_/_async_to_generator":"6SrlH","@swc/helpers/_/_ts_generator":"dgtxH","@parcel/transformer-js/src/esmodule-helpers.js":"bFO5N"}]},[],null,"parcelRequireffbd");
//# sourceMappingURL=web.d44f1718.js.map
